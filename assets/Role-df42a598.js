import{r as h,b as x,d as j,e as b,o as d,i as g,g as s,w as n,u as a,F as w,f as i,a as u,t as _,j as z,q as S,c as N}from"./app-bc212b95.js";import{_ as I,E as v,L as O,a as B,M as W,j as A,k as T}from"./AuthenticatedLayout-50ff9968.js";import{E as L}from"./index-32a7580d.js";import{E as F,a as C}from"./index-85e0eb70.js";import{E as q}from"./index-6a69cc2c.js";import{E as K}from"./index-454779f0.js";import{E as G,b as H,a as J}from"./index-68edb8cc.js";import{E as Q}from"./index-26516851.js";import{E as X}from"./index-1e689d51.js";import"./validator-fd88d94b.js";import"./index-c08cf1d8.js";const Y={class:"px-5 pt-4 font-semibold text-xl text-gray-800 leading-tight"},Z=i("br",null,null,-1),ee={class:"flex justify-end pt-2"},ae={class:"pb-2"},te=i("label",{for:""},[u("Name "),i("span",{class:"text-red-600"},"*")],-1),le={key:0,class:"text-red-600"},se=i("label",{for:""},[u("Permissions "),i("span",{class:"text-red-600"},"*")],-1),ne={key:0,class:"text-red-600"},oe={class:"flex justify-end"},ye={__name:"Role",props:["all_permissions"],setup(U){const y=h({}),k=x(document.documentElement.clientWidth),m=x(!1),t=h({}),r=h({order_by:null,order_at:null,page_size:10,page:1}),V=x(0),p=h({});j(()=>{t.value={name:null,permissions:null},p.value={},c()});function M(o){o.order?(r.order_by=o.order=="ascending"?"asc":"desc",r.order_at=o.column.label):(r.order_by=null,r.order_at=null),c()}const c=()=>{b.get(route("role.show",r)).then(o=>{const l=o.data.data;y.value=l.data,V.value=l.total})},P=o=>{t.value={id:o.id,name:o.name,permissions:o.permissions},m.value=!0},D=o=>{X.confirm("Are you sure you want to delete this data?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{T({type:"success",message:"Deleted successfully"}),await b.post(route("role.delete",o)).finally(()=>{c()})}).catch(()=>{})},R=()=>{t.value={name:null,permissions:null},m.value=!0};window.addEventListener("resize",()=>{k.value=document.documentElement.clientWidth});const $=async()=>{var l;const o=(l=t==null?void 0:t.value)!=null&&l.id?route("role.update",t.value.id):route("role.store");await b.post(o,t.value).then(f=>{T({type:"success",message:"Updated successfully"}),m.value=!1,c()}).catch(f=>{p.value=f.response.data.errors})};return(o,l)=>{var f;return d(),g(w,null,[s(I,null,{default:n(()=>[i("h2",Y,[u(" Roles "),Z,s(a(v),{onClick:R,class:"my-2",type:"primary",icon:a(O),plain:""},{default:n(()=>[u("New")]),_:1},8,["icon"])]),s(a(L),{class:"m-5 mt-1",shadow:"always"},{default:n(()=>[s(a(F),{data:(y==null?void 0:y.value)??[],"row-key":"id",onSortChange:M,"header-row-class-name":"thead-light"},{default:n(()=>[s(a(C),{"min-width":"220px",label:"NAME",sortable:""},{default:n(({row:e})=>[u(_(e.name),1)]),_:1}),s(a(C),{"min-width":"130px",label:"PERMISSIONS"},{default:n(({row:e})=>[(d(!0),g(w,null,z(e.permissions??[],E=>(d(),N(a(H),{type:"success"},{default:n(()=>[u(_(E),1)]),_:2},1024))),256))]),_:1}),s(a(C),{width:"157px",label:"ACTION",fixed:"right"},{default:n(({row:e})=>[s(a(B),{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:n(()=>[s(a(v),{type:"primary",size:"small",icon:a(W),onClick:E=>P(e)},null,8,["icon","onClick"])]),_:2},1024),s(a(B),{class:"box-item",effect:"dark",content:"Delete",placement:"top-start"},{default:n(()=>[s(a(v),{type:"danger",size:"small",icon:a(A),onClick:E=>D(e.id)},null,8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"]),i("div",ee,[s(a(q),{currentPage:r.page,"onUpdate:currentPage":l[0]||(l[0]=e=>r.page=e),"page-size":r.page_size,"onUpdate:pageSize":l[1]||(l[1]=e=>r.page_size=e),"page-sizes":[5,10,50,100],background:"",layout:"total, sizes, prev, pager, next",total:V.value,onSizeChange:c,onCurrentChange:c},null,8,["currentPage","page-size","total"])])]),_:1})]),_:1}),s(a(Q),{width:k.value>700?"50%":"70%",modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value=e),title:`${(f=t==null?void 0:t.value)!=null&&f.id?"Update":"New"} Role`,"close-on-click-modal":!1},{footer:n(()=>[i("span",oe,[s(a(v),{type:"warning",onClick:l[4]||(l[4]=e=>m.value=!1),plain:""},{default:n(()=>[u("Cancel")]),_:1}),s(a(v),{type:"primary",onClick:$},{default:n(()=>{var e;return[u(_((e=t==null?void 0:t.value)!=null&&e.id?"Update":"Save"),1)]}),_:1})])]),default:n(()=>[i("div",ae,[te,s(a(K),{modelValue:t.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.name=e),maxlength:"200",placeholder:"Enter role name.",type:"text",clearable:""},null,8,["modelValue"]),p.value.name?(d(),g("span",le,_(p.value.name[0]),1)):S("",!0)]),i("div",null,[se,s(a(G),{modelValue:t.value.permissions,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.permissions=e),filterable:"",multiple:"",placeholder:"Select Permissions",clearable:"",style:{width:"100%"}},{default:n(()=>[(d(!0),g(w,null,z(U.all_permissions,e=>(d(),N(a(J),{label:e.name,value:e.name},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),p.value.permissions?(d(),g("span",ne,_(p.value.permissions[0]),1)):S("",!0)])]),_:1},8,["width","modelValue","title"])],64)}}};export{ye as default};
